{
  "project_name": "eunomia-todo",
  "tasks": [
    {
      "task_id": "REQ-001",
      "task_type": "modify",
      "recommended_model": "sonnet",
      "title": "Implement PUT /api/todos/:id endpoint with validation",
      "description": "Add a PUT /api/todos/:id endpoint to backend/src/index.js that updates an existing todo with partial updates.\n\n**Context:**\n- Read backend/src/index.js to understand existing route patterns (lines 53-70 for GET by ID, lines 72-98 for POST)\n- Database schema includes: id, title, description, completed, created_at, updated_at (see backend/src/db.js lines 17-26)\n- Database has an auto-update trigger for updated_at timestamp (backend/src/db.js lines 31-40)\n\n**Implementation Requirements:**\n1. Add PUT /api/todos/:id route after the POST /api/todos route (after line 98)\n2. Accept partial updates: { title?, description?, completed? } from req.body\n3. Validate todo exists (return 404 with { error: 'Todo not found' } if not found)\n4. Validate title if provided:\n   - Return 400 with { error: 'Title cannot be empty' } if title is empty string\n   - Return 400 with { error: 'Title must be 200 characters or less' } if title > 200 chars\n5. Build dynamic UPDATE query only for provided fields\n6. The updated_at timestamp will be automatically updated by the database trigger\n7. Return the updated todo object with status 200\n8. Handle database errors with 500 status\n\n**CRITICAL: Write comprehensive tests**\nCreate backend/src/put-todo-by-id.test.js following the existing test pattern from backend/src/get-todo-by-id.test.js and backend/src/post-todos.test.js.\n\nTest cases must include:\n1. PUT with valid title update returns 200 with updated todo\n2. PUT with valid description update returns 200 with updated todo\n3. PUT with valid completed status update returns 200 with updated todo\n4. PUT with multiple fields updated returns 200 with updated todo\n5. PUT with partial update (only one field) returns 200\n6. PUT with empty object {} returns 200 (no changes)\n7. PUT with non-existent ID returns 404 with error message\n8. PUT with empty title returns 400 with error message\n9. PUT with title > 200 chars returns 400 with error message\n10. Verify updated_at timestamp changes after update\n11. Verify created_at timestamp does NOT change after update\n12. Verify returned todo has all required fields\n\nUse the same test structure: db operations for validation, assert library, cleanup test data.",
      "dependencies": [],
      "acceptance_criteria": [
        "PUT /api/todos/:id endpoint accepts partial updates for title, description, and completed",
        "Returns 404 with error message when todo ID does not exist",
        "Returns 400 when title is provided but empty",
        "Returns 400 when title is provided but exceeds 200 characters",
        "Returns 200 with updated todo object on successful update",
        "updated_at timestamp is automatically updated on change",
        "Test file backend/src/put-todo-by-id.test.js created with all test cases",
        "All test cases validate endpoint behavior correctly"
      ],
      "filename": "backend/src/index.js",
      "language": "javascript"
    },
    {
      "task_id": "QA-001",
      "task_type": "qa_validation",
      "recommended_model": "haiku",
      "title": "Validate PUT /api/todos/:id endpoint tests",
      "description": "Run the test suite for the PUT /api/todos/:id endpoint to validate implementation.\n\n**Validation Steps:**\n1. Run: node backend/src/put-todo-by-id.test.js\n2. Verify all test cases pass:\n   - PUT with valid title update\n   - PUT with valid description update\n   - PUT with valid completed status update\n   - PUT with multiple fields updated\n   - PUT with partial update\n   - PUT with empty object\n   - PUT with non-existent ID returns 404\n   - PUT with empty title returns 400\n   - PUT with title > 200 chars returns 400\n   - Verify updated_at timestamp changes\n   - Verify created_at timestamp unchanged\n   - Verify returned todo structure\n3. Ensure all tests output âœ… success message\n4. Verify test data cleanup completes successfully",
      "dependencies": ["REQ-001"],
      "acceptance_criteria": [
        "All tests in backend/src/put-todo-by-id.test.js pass successfully",
        "No test failures or errors reported",
        "Test output confirms all validation scenarios work correctly"
      ],
      "filename": "backend/src/put-todo-by-id.test.js",
      "language": "javascript"
    }
  ]
}
